!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.vueutils=t():e.vueutils=t()}(self,(function(){return(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function s(e,t,n){t.headers=t.headers||{},t.asForm&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.asJson&&(t.headers.Accept="application/json"),t.asVndLichessV3Json&&(t.headers.Accept="application/vnd.lichess.v3+json",t.asJson=!0),t.asNdjson&&(t.headers.Accept="application/x-ndjson"),t.accessToken&&(t.headers.Authorization="Bearer "+t.accessToken),t.server?api("request:fetch",{url:e,params:t},(function(e){return n(e)})):fetch(e,t).then((function(e){return e.text().then((function(e){if(t.asJson||t.asNdjson)try{var o;o=t.asNdjson?e.split("\n").filter((function(e){return e.length})).map((function(e){return JSON.parse(e)})):JSON.parse(e);try{n({ok:!0,content:o})}catch(e){console.log(e,o)}}catch(e){console.log("fetch parse json error",e),n({ok:!1,status:"Error: Could not parse json."})}else n({ok:!0,content:e})}),(function(e){console.log("fetch get response text error",e),n({ok:!1,status:"Error: Failed to get response text."})}))}),(function(e){console.log("fetch error",e),n({ok:!1,status:"Error: Failed to fetch."})}))}function i(e,t){var n=localStorage.getItem(e);if(null===n)return t;try{return JSON.parse(n)}catch(e){return t}}function a(e,t){localStorage.setItem(e,JSON.stringify(t,null,2))}e.r(t),e.d(t,{simpleFetch:()=>s,getLocal:()=>i,setLocal:()=>a,BookMove:()=>u,BookPosition:()=>l});var c={0:{class:"unrated"},1:{class:"forcedloss"},2:{class:"losing"},3:{class:"troll"},4:{class:"dubious"},5:{class:"experimental"},6:{class:"stable"},7:{class:"promising"},8:{class:"good"},9:{class:"winning"},10:{class:"forcedwin"}},u=function(){function e(t){n(this,e),this.blob={san:t,rating:0}}return r(e,[{key:"serialize",value:function(){return this.blob}},{key:"deserialize",value:function(e){return this.blob={san:e.san,rating:e.rating||0},this}},{key:"rating",get:function(){return this.blob.rating},set:function(e){this.blob.rating=e}},{key:"class",get:function(){return c[this.rating].class}}]),e}(),l=function(){function e(t,o){n(this,e),this.blob={variant:t,fen:o,moves:{}},this.fromStored()}return r(e,[{key:"variant",get:function(){return this.blob.variant},set:function(e){this.blob.variant=e}},{key:"fen",get:function(){return this.blob.fen},set:function(e){this.blob.fen=e}},{key:"storeKey",get:function(){return"bookposition/".concat(this.variant,"/").concat(this.fen)}},{key:"getStoredBlob",value:function(){return i(this.storeKey,this.blob)}},{key:"storeBlob",value:function(){return a(this.storeKey,this.serialize()),this}},{key:"fromStored",value:function(){var e=this.getStoredBlob();return this.deserialize(e)}},{key:"moves",get:function(){return this.blob.moves},set:function(e){this.blob.moves=e}},{key:"serialize",value:function(){return{variant:this.variant,fen:this.fen,moves:Object.fromEntries(Object.entries(this.moves).map((function(e){return[e[0],e[1].serialize()]})))}}},{key:"getMove",value:function(e){var t=this.moves[e]||new u(e);return this.moves[e]=t,t}},{key:"getRating",value:function(e){return this.getMove(e).rating}},{key:"setRating",value:function(e,t){this.getMove(e).rating=t}},{key:"getClass",value:function(e){return this.getMove(e).class}},{key:"deserialize",value:function(e){return this.variant=e.variant,this.fen=e.fen,this.moves=Object.fromEntries(Object.entries(e.moves).map((function(e){return[e[0],(new u).deserialize(e[1])]}))),this}}]),e}();return t})()}));